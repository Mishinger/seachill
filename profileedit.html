<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Edit profile ‚Ä¢ SeaChill</title>
  <link rel="icon" type="image/png" href="logo.png" />
  <link rel="stylesheet" href="light.css" />
  <link id="themeStylesheet" rel="stylesheet" href="light.css" />
</head>
<body>
  <main>
    <header>
      <button class="button-text" id="saveBtn">‚Üê Back</button>
      <h1>‚úèÔ∏è Edit SeaChill profile</h1>
      <p>Your vibe, your emoji ‚Äî make it shine bro</p>
    </header>

    <section>
      <h3>Name</h3>
      <input type="text" id="nameInput" placeholder="Name" />
      <br/><br/>

      <h3>Emoji avatar</h3>
      <input type="text" id="emojiInput" placeholder="Emoji" style="font-size: 2rem; text-align: center;" />
      <div style="text-align: center;">
        <button id="surpriseBtn" title="Random emoji" class="button-text" style="margin-left: 0.5em;">üé≤</button>
      </div>
      <br/><br/>

      <h3>Gender</h3>
      <select id="genderInput">
        <option value="">Not set</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
        <option value="Nonbinary">Nonbinary</option>
        <option value="Prefer not to say">Prefer not to say</option>
      </select>
      <br/><br/>

      <h3>Bio</h3>
      <textarea id="bioInput" placeholder="Tell us your beach vibe‚Ä¶" rows="3"></textarea>
      <div style="text-align: center;">
        
      </div>
      <br/><br/>

      <h3>Avatar background color</h3>
      <input type="color" id="colorInput" value="#00bcd4" />
      <br/><br/>
    </section>

    <footer>
      <p><em>Your info never leaves your beach towel üêö</em></p>
    </footer>
  </main>

  <script>
    // üåó Theme handler
    const themeMap = {
      light: "light.css",
      dark: "dark.css",
      twilight: "twilight.css",
      jungle: "jungle.css",
      breeze: "breeze.css",
      void: "void.css"
    };
    const selectedTheme = localStorage.getItem("preferredTheme") || "system";
    const themeEl = document.getElementById("themeStylesheet");

    themeEl.href = themeMap[selectedTheme] || (
      window.matchMedia("(prefers-color-scheme: dark)").matches ? themeMap.dark : themeMap.light
    );

    // üéõÔ∏è Form setup
    const $ = id => document.getElementById(id);
    const profile = JSON.parse(localStorage.getItem("seaProfile") || "{}");

    $("nameInput").value   = profile.username || "";
    $("emojiInput").value  = profile.avatar || "üå¥";
    $("genderInput").value = profile.gender || "";
    $("bioInput").value    = profile.bio || "";
    $("colorInput").value  = profile.color || "#00bcd4";

    // üßç Preserve full emoji graphemes (e.g. skin tones)
    $("emojiInput").addEventListener("input", () => {
      const graphemes = Array.from($("emojiInput").value);
      $("emojiInput").value = graphemes.slice(0, 1).join(""); // keep full visual emoji
    });

    // üé≤ Surprise button
    const emojiPool = [
      "üå¥", "üçç", "üèÑüèª‚Äç‚ôÇÔ∏è", "üßúüèæ‚Äç‚ôÄÔ∏è", "ü™∏", "üê†", "‚òÄÔ∏è", "üåä", "ü¶Ä", "üêö", "üèñÔ∏è", "üë®üèΩ‚Äçü¶±", "üë®üèª", "üßëüèª", "üë©üèΩ", "üå∫", "üåÖ", "üß≠", "üë®üèª‚Äçü¶±", "üíß", "üòÄ", "ü••", "üçπ", "üç∏", "ü•ù", "üçâ", "üèÑüèª‚Äç‚ôÇÔ∏è", "üèÑüèæ‚Äç‚ôÄÔ∏è", "üêÖ", "üçÉ", "üêÜ"
    ];
    $("surpriseBtn").onclick = () => {
      const random = emojiPool[Math.floor(Math.random() * emojiPool.length)];
      $("emojiInput").value = random;
    };

    // üíæ Save handler
    $("saveBtn").onclick = () => {
      const updated = {
        username: $("nameInput").value.trim(),
        avatar: $("emojiInput").value.trim(),
        gender: $("genderInput").value,
        bio: $("bioInput").value.trim(),
        color: $("colorInput").value
      };
      localStorage.setItem("seaProfile", JSON.stringify(updated));
      window.location.href = "profile.html"
    };
  </script>
</body>
</html>